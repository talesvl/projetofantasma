---
title: "Projeto Fantasma - House of Excellence"

# Nome do documento PDF gerado
output-file: projeto_fantasma_tales
project:
  title: "Projeto Fantasma-House of Excellence" # É interessante mudar o nome do projeto para gestão de conhecimento
  output-dir: resultados/


lang: pt

format: 
  pdf:
    geometry: 
      - left=3cm 
      - right=2cm 
      - top=3cm 
      - bottom=2cm 
    documentclass: estat/estat
    toc: true
    toc-title: "Sumário"
    mainfont: Arial 
    
    linkcolor: black 
    filecolor: black
    citecolor: black
    urlcolor: black 
    number-sections: true
    
    fig-width: 6.2
    fig-height: 3.66


crossref: 
  fig-title: Figura
  fig-prefix: ""
  tbl-title: Tabela
  tbl-prefix: ""
  title-delim: ":"

execute: 
  message: false
  warning: false
  echo: false
  error: false
  quiet: true


  
    

include-in-header:
  - file: arquivos_tex/nome_dos_alocados_e_do_cliente.tex # Arrumando para adicionar os autores e o cliente
  - file: arquivos_tex/outros_detalhes.tex

include-before-body: 
  - file: arquivos_tex/logo.tex
  



editor: visual
---

```{r}
#| include: false
source("rdocs/source/packages.R")
```

```{r}
library(ggplot2)
library(readxl)
library(latexpdf)
library(tidyverse)
library(dplyr)
library(tinytex)
dados<-read_excel("E:/arquivos R/Olimpiadas 2000 - 2016.xlsx")
Olimpiadas_ATHENAS <- read_excel("E:/arquivos R/Olimpiadas 2000 - 2016.xlsx", 
    sheet = "Athina")
Olimpiadas_BEIJING <- read_excel("E:/arquivos R/Olimpiadas 2000 - 2016.xlsx", 
    sheet = "Beijing")
Olimpiadas_LONDRES <- read_excel("E:/arquivos R/Olimpiadas 2000 - 2016.xlsx", 
    sheet = "London")
Olimpiadas_RIO <- read_excel("E:/arquivos R/Olimpiadas 2000 - 2016.xlsx", 
    sheet = "Rio de Janeiro")
Olimpiadas_SIDNEY <- read_excel("E:/arquivos R/Olimpiadas 2000 - 2016.xlsx", 
    sheet = "Sydney")


colnames(Olimpiadas_ATHENAS)<-c("Names","Gender","Age","Height (cm)","Weight (lbs)","Team","Sport","Event","Medal")
colnames(Olimpiadas_BEIJING)<-c("Names","Gender","Age","Height (cm)","Weight (lbs)","Team","Sport","Event","Medal")
colnames(Olimpiadas_LONDRES)<-c("Names","Gender","Age","Height (cm)","Weight (lbs)","Team","Sport","Event","Medal")
colnames(Olimpiadas_RIO)<-c("Names","Gender","Age","Height (cm)","Weight (lbs)","Team","Sport","Event","Medal")
colnames(Olimpiadas_SIDNEY)<-c("Names","Gender","Age","Height (cm)","Weight (lbs)","Team","Sport","Event","Medal")


dados<-rbind(Olimpiadas_ATHENAS,Olimpiadas_BEIJING,Olimpiadas_LONDRES,Olimpiadas_RIO,Olimpiadas_SIDNEY)
dados<-dados %>% filter(!is.na(dados$Medal))
dados$`Weight (lbs)`<-dados$`Weight (lbs)`*0.45359237
dados$`Height (cm)`<-dados$`Height (cm)`/100
dados<-mutate(dados, IMC=dados$`Weight (lbs)`/(dados$`Height (cm)`**2))


dados_mulheres<-filter(dados,Gender=="F")


frequencia_mulheres <- dados_mulheres %>%
  filter(!is.na(Team)) %>%
  count(Team) %>%
  mutate(
    freq = n,
    relative_freq = round((freq / sum(freq)) * 100, 1),
    freq = gsub("\\.", ",", relative_freq) %>% paste("%", sep = ""),
    label = str_c(n, " (", freq, ")") %>% str_squish()
)

mulheres5<-arrange(frequencia_mulheres,n)
mulheres5<-tail(mulheres5,5)
mulheres5<-arrange(mulheres5,desc(n))
mulheres5$Team<-c("Estados Unidos","Rússia","China","Austrália","Alemanha")


######################################

dados_esporte<-filter(dados, Sport %in% c("Gymnastics","Football","Judo","Athletics","Badminton"))
dados_esporte <- dados_esporte %>%
  filter(!is.na(`Height (cm)`))
dados_esporte <- dados_esporte %>%
  filter(!is.na(`Weight (lbs)`))


dados_esporte$Sport<-factor(dados_esporte$Sport)
levels(dados_esporte$Sport)[levels(dados_esporte$Sport) %in% c("Athletics")]<-"Atletismo"
levels(dados_esporte$Sport)[levels(dados_esporte$Sport) %in% c("Gymnastics")]<-"Ginástica"
levels(dados_esporte$Sport)[levels(dados_esporte$Sport) %in% c("Football")]<-"Futebol"
levels(dados_esporte$Sport)[levels(dados_esporte$Sport) %in% c("Judo")]<-"Judô"


######################################

dados_individual <- dados%>%
  count(Names,Medal) %>%
  mutate(
    freq = n,
    label = str_c(n) %>% str_squish()
  )
dados_individual2 <- dados%>%
  count(Names) %>%
  mutate(
    freq = n)

dados_individual<-left_join(dados_individual,dados_individual2,by="Names")
rm(dados_individual2)
top3<-dados_individual

top3<-arrange(top3,desc(n.y))
top3<-head(top3,9)
top3[4]<-c("7,1%","82,1%","10,8%","41,7%","25%","33,3%","25%","50%","25%")


#######################################

dados2<-dados
dados2<-dados2 %>% filter(!is.na(dados2$`Height (cm)`))
dados2<-dados2 %>% filter(!is.na(dados2$`Weight (lbs)`))
spearman<-cor(dados2$`Height (cm)`,dados2$`Weight (lbs)`, method = "spearman",)
```

# Introdução

## Sobre o relatório

Este relatório tem como objetivo realizar análises estatísticas que visam otimizar o desempenho dos atletas de elite da House of Excellence, que participaram das olimpíadas dos anos de 2000 até 2016. Neste, contém quatro análises sobre diversos aspectos que vão auxiliar no melhor entendimento sobre eles: 1.Top 5 países com maior número de mulheres medalhistas. 2.Valor IMC por esporte, estes sendo, ginástica, futebol, judô, atletismo e badminton. 3.Top 3 medalhistas gerais por quantidade de cada tipo de medalha. 4.Variação Peso por Altura. Foi realizado para as análises a filtragem de apenas atletas premiados pelo seu desempenho com uma medalha.

## Sobre o banco de dados

A coleta dos dados foi feita pela House of Excellence, contendo dados sobre:\

● Name: O nome do atleta.

● Gender: O gênero do atleta.

● Age: A idade do atleta.

● Height: A altura do atleta, em centímetros.

● Weight: O peso do atleta, em libras.

● Team: O país pelo qual o atleta está competindo.

● Sport: O esporte que o atleta compete.

● Event: A modalidade, “evento”, que o atleta conquistou a medalha.

● Medal: O tipo de medalha ganha, sendo ouro, prata ou bronze.

## Software utilizado para análise

RStudio versão: "R-4.4.3"

# Análise 1

Nesta análise, foi feito o estudo da frequência relativa da variável quantitativa discreta, número de medalhistas, por país no banco de dados sobre atletas que participaram dos Jogos Olímpicos no ano de 2000-2016 na categoria feminina. Foram coletados dados de 94 países medalhistas e as 5 nações que tiveram mais representantes femininas medalhistas foram postas em um gráfico de barras univariado para uma melhor visualização.

```{r}
#| label: colunas-uni-freq
#| fig-cap: "Gráfico de colunas do número de medalhas por país"

ggplot(mulheres5) +
  aes(x = fct_reorder(Team, n, .desc=T), y = n, label = label) +
  geom_bar(stat = "identity", fill = "#A11D21", width = 0.7) +
  geom_text(
    position = position_dodge(width = .9),
    vjust = -0.5, #hjust = .5,
    size = 3
  ) +
  labs(x = "País", y = "Frequência") +
  theme_estat()
ggsave("colunas-uni-freq.pdf", width = 158, height = 93, units = "mm"
)
```

Analisando cada nação, percebe-se por meio da *Figura 1* que o número de medalhistas é desigual. O gráfico indica que os 5 países que mais tiveram medalhistas na categoria feminina nos Jogos Olímpicos entre as edições de 2000 até 2016 foram, em primeiro lugar de maneira isolada, os Estados Unidos (741), seguido pela Rússia (416), na terceira posição se encontra a China (384), em quarto colocado a Austrália (340) e mais afastada dos demais, a Alemanha (268) em quinto colocado fechando o ranking. Observa-se uma notória liderança dos Estados Unidos com 7.1 pontos percentuais maior que o segundo colocado na análise, Rússia. Dessa forma, indicando que existe, nos Jogos Olímpicos, a soberania de atletas estadunidenses.

# Análise 2

Nesta análise, foi comparada a variável quantitativa contínua "IMC", Índice de Massa Corporal, em cada modalidade olímpica, sendo essas: atletismo, ginástica, badminton, futebol e judô. O cálculo desse índice se dá pela formula:

$$
IMC=(peso/altura^2)
$$

Essa medida serve como um parâmetro simples para o controle do peso corporal ideal pra sua altura ou tarefa que deseja realizar. Para essa análise, foi feito um gráfico em *Boxplot* bivariado em que está em ordem crescente a mediana do IMC em cada esporte.

```{r}
#| fig-cap: "Gráfico em Boxplot do IMC do atleta por esporte"

ggplot(dados_esporte) +
  aes(x = reorder(Sport, IMC, FUN= median), y = IMC) +
  geom_boxplot(fill = c("#A11D21"), width = 0.5) +
  stat_summary(
    fun = "mean", geom = "point", shape = 23, size = 3, fill = "white"
  ) +
  labs(x = "Esporte", y = "IMC") +
  theme_estat()
ggsave("box_bi4.pdf", width = 158, height = 93, units = "mm")
```

Avaliando o IMC dos esportes pela *Figura 2*, é perceptível que cada esporte possui um IMC ideal para uma melhor performance, sendo necessário um Índice de Massa Corporal menor para atletas da ginástica em comparação ao atletismo, que por sua vez é inferior ao dos atletas de badminton, com um índice maior vem em seguida os atletas de futebol e entre todos os esportes analisados, os mais pesados são, com uma grande diferença, os atletas de judô.

Pelo gráfico é perceptível que existe bastante variação e a presença de valores estremos no IMC de atletas do judô e de atletismo, isso se deve por conta da divisão das modalidades, sendo no atletismo, desde maratonas, na qual requer atletas mais leves e condicionados, até arremesso de peso, no qual requer atletas mais pesados e forte, já no judô, existe a divisão de peso na competição indo de extra peso leve à peso pesado. Na *Figura 2* é perceptível analisar sobre a ginástica que, em um esporte onde predomina a agilidade, equilíbrio, flexibilidade e coordenação, assim, peso corporal baixo é sinônimo de bom rendimento nesse esporte.

# Análise 3

Nesta análise, o foco do estudo foi a variável qualitativa ordinal medalha, sendo elas a de ouro, prata e bronze conquistada pelos 3 atletas que mais acumularam essas premiações nas edições dos Jogos Olímpicos analisados. Após isso, foi feita a divisão no número total de medalhas de acordo com o seu tipo e posta em um gráfico em barras bivariado para uma melhor percepção.

```{r}
#| fig-cap: "Gráfico em barras da frequência e do tipo de medalha por atleta"

porcentagens <- str_c(top3$freq.x) %>% str_replace("\\.", ",")
legendas <- str_squish(str_c(top3$n.x, " (", porcentagens, ")"))
ggplot(top3) +
  aes(
    x = Names, y = n.x,
    fill = Medal, label = legendas
  ) +
  geom_col(position = position_dodge2(preserve = "single", padding =0)) +
  geom_text(
    position = position_dodge(width = .9),
    vjust = -0.5, hjust = 0.5,
    size = 2.9
  ) +
  labs(x = "Atleta", y = "Frequência") +
  theme_estat()
ggsave("colunas-bi-freq3.pdf", width = 158, height = 93, units = "mm")

```

Para essa análise podemos observar os 3 atletas que mais conquistaram medalhas nas Olimpíadas 2000-2016, pela *Figura 3* é possível observar que o atleta Michael Phelps foi o atleta mais vezes campeão (23) e com mais medalhas (28), já a atleta Natalie Coughlin foi a segunda colocada com mais medalhas da contagem absoluta (12) bem dividido entre ouro, bronze e prata, em terceiro colocado o Ryan Lochte com 12 medalhas também, sendo em sua maioria ouro (6). Para essa análise foi feito a filtragem dos 3 atletas com mais medalhas. Contudo, por conta do empate técnico para a segunda colocação, como critério de desempate, a ordem alfabética foi preferível.

# Análise 4

Nesta análise, o intuito foi entender a relação entre a variável quantitativa contínua peso (peso corporal do atleta em quilogramas) e a variável quantitativa contínua altura (altura do atleta em metros). Foi feito um gráfico de dispersão multivariado entre essas características para um melhor estudo delas.

```{r}
#| fig-cap: "Gráfico de dispersão do peso e da altura do atleta"

ggplot(dados2) +
  aes(x = dados2$`Height (cm)`, y = dados2$`Weight (lbs)`) +
  geom_point(colour = "#A11D21", size = 1.8) +
  labs(
    x = "Altura",
    y = "Peso"
  ) +
  geom_smooth(se=F,color="black")+
  theme_estat()
ggsave("disp_uni2.pdf", width = 158, height = 93, units = "mm")
```

$$
ρ=0.84081
$$

Analisando o gráfico da *Figura 4* juntamente ao Coeficiente de Correlação de Spearman (\>0.84), é possível determinar que a relação entre o peso e a altura do atleta é muito forte e positiva, ou seja, a medida em que o peso do atleta aumenta, a altura tende à aumentar proporcionalmente e vice-versa, o mesmo efeito ocorre caso alguma dessas medidas diminua.
