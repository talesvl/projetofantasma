theme_estat()
ggplot(dados_ginástica_futebol_judô_atletismo_badminton) +
aes(x = reorder(Sport, IMC, FUN= median), y = IMC) +
geom_boxplot(fill = c("#A11D21"), width = 0.5) +
stat_summary(
fun = "mean", geom = "point", shape = 23, size = 3, fill = "white"
) +
labs(x = "Esporte", y = "IMC") +
ylim(15,30)
theme_estat()
ggplot(dados_ginástica_futebol_judô_atletismo_badminton) +
aes(x = reorder(Sport, IMC, FUN= median), y = IMC) +
geom_boxplot(fill = c("#A11D21"), width = 0.5) +
stat_summary(
fun = "mean", geom = "point", shape = 23, size = 3, fill = "white"
) +
labs(x = "Esporte", y = "IMC") +
theme_estat()
ggplot(dados_ginástica_futebol_judô_atletismo_badminton) +
aes(x = reorder(Sport, IMC, FUN= mean), y = IMC) +
geom_boxplot(fill = c("#A11D21"), width = 0.5) +
stat_summary(
fun = "mean", geom = "point", shape = 23, size = 3, fill = "white"
) +
labs(x = "Esporte", y = "IMC") +
theme_estat()
ggplot(dados_ginástica_futebol_judô_atletismo_badminton) +
aes(x = reorder(Sport, IMC, FUN= median), y = IMC) +
geom_boxplot(fill = c("#A11D21"), width = 0.5) +
stat_summary(
fun = "mean", geom = "point", shape = 23, size = 3, fill = "white"
) +
labs(x = "Esporte", y = "IMC") +
theme_estat()
ggplot(dados_ginástica_futebol_judô_atletismo_badminton) +
aes(x = reorder(Sport, IMC, FUN= median), y = IMC) +
geom_boxplot(fill = c("#A11D21"), width = 0.5) +
stat_summary(
fun = "mean", geom = "point", shape = 23, size = 3, fill = "white"
) +
labs(x = "Esporte", y = "IMC") +
theme_estat()
library(ggplot2)
library(readxl)
library(latexpdf)
library(tidyverse)
library(dplyr)
ggplot(dados_ginástica_futebol_judô_atletismo_badminton) +
aes(x = reorder(Sport, IMC, FUN= median), y = IMC) +
geom_boxplot(fill = c("#A11D21"), width = 0.5) +
stat_summary(
fun = "mean", geom = "point", shape = 23, size = 3, fill = "white"
) +
labs(x = "Esporte", y = "IMC") +
theme_estat()
View(dados_ginástica_futebol_judô_atletismo_badminton)
View(dados)
dados_ginástica_futebol_judô_atletismo_badminton<-na.omit(dados_ginástica_futebol_judô_atletismo_badminton)
View(dados_ginástica_futebol_judô_atletismo_badminton)
dados_ginástica_futebol_judô_atletismo_badminton<-na.omit(dados_ginástica_futebol_judô_atletismo_badminton$IMC)
dados$`Weight (lbs)`<-dados$`Weight (lbs)`*0.45359237
dados$`Height (cm)`<-dados$`Height (cm)`/100
library(ggplot2)
library(readxl)
library(latexpdf)
library(tidyverse)
library(dplyr)
dados<-read_excel("E:/arquivos R/Olimpiadas 2000 - 2016.xlsx")
dados_mulheres<-filter(dados,Gender=="F")
mulheres_medalha<-filter(dados_mulheres, Medal %in% c("Bronze","Silver","Gold"))
frequencia_feminina <- mulheres_medalha %>%
filter(!is.na(Team)) %>%
count(Team) %>%
mutate(
freq = n,
label = str_c(n) %>% str_squish()
)
top5_feminino_medalhas<-arrange(frequencia_feminina,desc(n))
top5_feminino_medalhas<-head(top5_feminino_medalhas,5)
top5_feminino_medalhas$Team<-c("Estados Unidos","Rússia","Alemanha","China","Austrália")
top5_feminino_medalhas_tabela<-select(top5_feminino_medalhas,Team,n)
colnames(top5_feminino_medalhas_tabela)<-c("País","Frequência")
dados$`Weight (lbs)`<-dados$`Weight (lbs)`*0.45359237
dados$`Height (cm)`<-dados$`Height (cm)`/100
dados<-mutate(dados, IMC=dados$`Weight (lbs)`/(dados$`Height (cm)`**2))
dados_ginástica_futebol_judô_atletismo_badminton<-filter(dados, Sport %in% c("Gymnastics","Football","Judo","Athletics","Badminton"))
dados_ginástica_futebol_judô_atletismo_badminton<-na.omit(dados_ginástica_futebol_judô_atletismo_badminton$IMC)
estat_colors <- c(
"#A11D21", "#003366", "#CC9900",
"#663333", "#FF6600", "#CC9966",
"#999966", "#006606", "#008091",
"#041835", "#666666" )
theme_estat <- function(...) {
theme <- ggplot2::theme_bw() +
ggplot2::theme(
axis.title.y = ggplot2::element_text(colour = "black", size = 12),
axis.title.x = ggplot2::element_text(colour = "black", size = 12),
axis.text = ggplot2::element_text(colour = "black", size = 9.5)
,
panel.border = ggplot2::element_blank(),
axis.line = ggplot2::element_line(colour = "black"),
legend.position = "top",
...
)
return(
list(
theme,
scale_fill_manual(values = estat_colors),
scale_colour_manual(values = estat_colors)
)
)
}
dados_ginástica_futebol_judô_atletismo_badminton<-filter(dados, Sport %in% c("Gymnastics","Football","Judo","Athletics","Badminton"))
View(dados_ginástica_futebol_judô_atletismo_badminton)
dados_ginástica_futebol_judô_atletismo_badminton <- dados_ginástica_futebol_judô_atletismo_badminton %>%
filter(!is.na(dados_ginástica_futebol_judô_atletismo_badminton$`Height (cm)`,dados_ginástica_futebol_judô_atletismo_badminton$`Weight (lbs)`))
dados_ginástica_futebol_judô_atletismo_badminton <- dados_ginástica_futebol_judô_atletismo_badminton %>%
filter(!is.na(dados_ginástica_futebol_judô_atletismo_badminton$`Height (cm))
dados_ginástica_futebol_judô_atletismo_badminton <- dados_ginástica_futebol_judô_atletismo_badminton %>%
filter(!is.na(dados_ginástica_futebol_judô_atletismo_badminton$`Weight (lbs)`))
dados_ginástica_futebol_judô_atletismo_badminton <- dados_ginástica_futebol_judô_atletismo_badminton %>%
filter(!is.na(dados_ginástica_futebol_judô_atletismo_badminton$`Weight (lbs)))
View(dados_ginástica_futebol_judô_atletismo_badminton)
View(dados_ginástica_futebol_judô_atletismo_badminton)
dados_ginástica_futebol_judô_atletismo_badminton<-filter(dados, Sport %in% c("Gymnastics","Football","Judo","Athletics","Badminton"))
dados_ginástica_futebol_judô_atletismo_badminton <- dados_ginástica_futebol_judô_atletismo_badminton %>%
filter(!is.na(dados_ginástica_futebol_judô_atletismo_badminton$`Height (cm))
dados_ginástica_futebol_judô_atletismo_badminton <- dados_ginástica_futebol_judô_atletismo_badminton %>%
filter(!is.na(`Height (cm)`))
dados_ginástica_futebol_judô_atletismo_badminton <- dados_ginástica_futebol_judô_atletismo_badminton %>%
filter(!is.na(`Height (cm)`))
dados_ginástica_futebol_judô_atletismo_badminton <- dados_ginástica_futebol_judô_atletismo_badminton %>%
filter(!is.na(`Weight (lbs)`))
View(dados_ginástica_futebol_judô_atletismo_badminton)
ggplot(dados_ginástica_futebol_judô_atletismo_badminton) +
aes(x = reorder(Sport, IMC, FUN= median), y = IMC) +
geom_boxplot(fill = c("#A11D21"), width = 0.5) +
stat_summary(
fun = "mean", geom = "point", shape = 23, size = 3, fill = "white"
) +
labs(x = "Esporte", y = "IMC") +
ylim(15,35)+
theme_estat()
ggplot(dados_ginástica_futebol_judô_atletismo_badminton) +
aes(x = reorder(Sport, IMC, FUN= median), y = IMC) +
geom_boxplot(fill = c("#A11D21"), width = 0.5) +
stat_summary(
fun = "mean", geom = "point", shape = 23, size = 3, fill = "white"
) +
labs(x = "Esporte", y = "IMC") +
ylim(15,35)+
theme_estat()
ggplot(dados_ginástica_futebol_judô_atletismo_badminton) +
aes(x = reorder(Sport, IMC, FUN= median), y = IMC) +
geom_boxplot(fill = c("#A11D21"), width = 0.5) +
stat_summary(
fun = "mean", geom = "point", shape = 23, size = 3, fill = "white"
) +
labs(x = "Esporte", y = "IMC") +
theme_estat()
View(dados_ginástica_futebol_judô_atletismo_badminton)
View(dados)
ggplot(dados_ginástica_futebol_judô_atletismo_badminton) +
aes(x = reorder(Sport, IMC, FUN= median), y = IMC) +
geom_boxplot(fill = c("#A11D21"), width = 0.5) +
stat_summary(
fun = "mean", geom = "point", shape = 23, size = 3, fill = "white"
) +
labs(x = "Esporte", y = "IMC") +
ylim(15,35)+
theme_estat()
#| label: colunas-uni-freq
#| fig-cap: "Gráfico número de medalhas feminino"
ggplot(top5_feminino_medalhas) +
aes(x = fct_reorder(Team, n, .desc=T), y = n, label = label) +
geom_bar(stat = "identity", fill = "#A11D21", width = 0.7) +
geom_text(
position = position_dodge(width = .9),
vjust = -0.5, #hjust = .5,
size = 3
) +
labs(x = "País", y = "Frequência") +
theme_estat()
rvcheck
install.packages("rvcheck")
library("rvcheck")
check_r()
View(dados)
medalhistas_geral<-filter(dados, Medal %in% c("Bronze","Silver","Gold"))
medalhistas_geral<-filter(dados, dados$Medal %in% c("Bronze","Silver","Gold"))
medalhistas_geral<-dados
medalhistas_geral<-filter(medalhistas_geral, Medal %in% c("Bronze","Silver","Gold"))
View(medalhistas_geral)
medalhistas_geral<-medalhistas_geral %>% filter(!is.na(Medal))
medalhistas_geral<-medalhistas_geral %>% filter(!is.na(Medal))
medalhistas_geral<-filter(medalhistas_geral, Medal %in% c("Bronze","Silver","Gold"))
medalhistas_geral<-filter(medalhistas_geral, Medal %in% c("Bronze","Silver","Gold"))
medalhistas_geral<-filter(medalhistas_geral, medalhistas_geral$Medal %in% c("Bronze","Silver","Gold"))
filter(medalhistas_geral, medalhistas_geral$Medal %in% c("Bronze","Silver","Gold"))
ggplot(mulheres_medalha) +
aes(x = fct_reorder(Team, n, .desc=T), y = n, label = label) +
geom_bar(stat = "identity", fill = "#A11D21", width = 0.7) +
geom_text(
position = position_dodge(width = .9),
vjust = -0.5, #hjust = .5,
size = 3
) +
labs(x = "País", y = "Frequência") +
theme_estat()
View(mulheres_medalha)
library(ggplot2)
library(readxl)
library(latexpdf)
library(tidyverse)
library(dplyr)
ggplot(mulheres_medalha) +
aes(x = fct_reorder(Team, n, .desc=T), y = n, label = label) +
geom_bar(stat = "identity", fill = "#A11D21", width = 0.7) +
geom_text(
position = position_dodge(width = .9),
vjust = -0.5, #hjust = .5,
size = 3
) +
labs(x = "País", y = "Frequência") +
theme_estat()
View(frequencia_feminina)
ggplot(frequencia_feminina) +
aes(x = fct_reorder(Team, n, .desc=T), y = n, label = label) +
geom_bar(stat = "identity", fill = "#A11D21", width = 0.7) +
geom_text(
position = position_dodge(width = .9),
vjust = -0.5, #hjust = .5,
size = 3
) +
labs(x = "País", y = "Frequência") +
theme_estat()
ggplot(frequencia_feminina) +
aes(x = fct_reorder(Team, n, .desc=T), y = n, label = label) +
geom_bar(stat = "identity", fill = "#A11D21", width = 0.7) +
geom_text(
position = position_dodge(width = .9),
vjust = -0.5, #hjust = .5,
size = 3
) +
labs(x = "País", y = "Frequência") +
xlim(0,5)+
theme_estat()
ggplot(top5_feminino_medalhas) +
aes(x = fct_reorder(Team, n, .desc=T), y = n, label = label) +
geom_bar(stat = "identity", fill = "#A11D21", width = 0.7) +
geom_text(
position = position_dodge(width = .9),
vjust = -0.5, #hjust = .5,
size = 3
) +
labs(x = "País", y = "Frequência") +
xlim(0,5)+
theme_estat()
ggplot(top5_feminino_medalhas) +
aes(x = fct_reorder(Team, n, .desc=T), y = n, label = label) +
geom_bar(stat = "identity", fill = "#A11D21", width = 0.7) +
geom_text(
position = position_dodge(width = .9),
vjust = -0.5, #hjust = .5,
size = 3
) +
labs(x = "País", y = "Frequência") +
theme_estat()
View(frequencia_feminina)
frequencia_feminina<-tail(frequencia_feminina$n,5)
frequencia_feminina<-tail(frequencia_feminina,5)
frequencia_feminina<-tail(frequencia_feminina,5)
ggplot(top5_feminino_medalhas) +
aes(x = fct_reorder(Team, n, .desc=T), y = n, label = label) +
geom_bar(stat = "identity", fill = "#A11D21", width = 0.7) +
geom_text(
position = position_dodge(width = .9),
vjust = -0.5, #hjust = .5,
size = 3
) +
labs(x = "País", y = "Frequência") +
theme_estat()
frequencia_feminina <- mulheres_medalha %>%
filter(!is.na(Team)) %>%
count(Team) %>%
mutate(
freq = n,
label = str_c(n) %>% str_squish()
)
mulheres_medalha <- mulheres_medalha %>%
filter(!is.na(Team)) %>%
count(Team) %>%
mutate(
freq = n,
label = str_c(n) %>% str_squish()
)
View(mulheres_medalha)
mulheres_medalha <- mulheres_medalha %>%
filter(!is.na(Team)) %>%
count(Team) %>%
mutate(
freq = n,
relative_freq = round((freq / sum(freq)) * 100, 1),
freq = gsub("\\.", ",", relative_freq) %>% paste("%", sep = ""),
label = str_c(n) %>% str_squish()
)
View(mulheres_medalha)
mulheres_medalha <- mulheres_medalha %>%
filter(!is.na(Team)) %>%
count(Team) %>%
mutate(
freq = n,
label = str_c(n) %>% str_squish()
)
View(mulheres_medalha)
View(dados_mulheres)
dados_mulheres_medalha<-dados_mulheres %>% filter(!is.na(Medal))
View(dados_mulheres_medalha)
dados_mulheres_medalha <- dados_mulheres_medalha %>%
filter(!is.na(Team)) %>%
count(Team) %>%
mutate(
freq = n,
relative_freq = round((freq / sum(freq)) * 100, 1),
freq = gsub("\\.", ",", relative_freq) %>% paste("%", sep = ""),
label = str_c(n) %>% str_squish()
)
View(dados_mulheres)
View(dados_mulheres_medalha)
ggplot(dados_mulheres_medalha) +
aes(x = fct_reorder(Team, n, .desc=T), y = n, label = label) +
geom_bar(stat = "identity", fill = "#A11D21", width = 0.7) +
geom_text(
position = position_dodge(width = .9),
vjust = -0.5, #hjust = .5,
size = 3
) +
labs(x = "País", y = "Frequência") +
theme_estat()
dados_mulheres_medalha <- dados_mulheres_medalha %>%
filter(!is.na(Team)) %>%
count(Team) %>%
mutate(
freq = n,
relative_freq = round((freq / sum(freq)) * 100, 1),
freq = gsub("\\.", ",", relative_freq) %>% paste("%", sep = ""),
label = str_c(n, " (", freq, ")") %>% str_squish()
)
View(dados_mulheres_medalha)
rm(dados_mulheres_medalha)
dados_mulheres_medalha<-dados_mulheres %>% filter(!is.na(Medal))
dados_mulheres_medalha <- dados_mulheres_medalha %>%
filter(!is.na(Team)) %>%
count(Team) %>%
mutate(
freq = n,
relative_freq = round((freq / sum(freq)) * 100, 1),
freq = gsub("\\.", ",", relative_freq) %>% paste("%", sep = ""),
label = str_c(n, " (", freq, ")") %>% str_squish()
)
View(dados_mulheres_medalha)
View(dados_mulheres_medalha)
ggplot(dados_mulheres_medalha) +
aes(x = fct_reorder(Team, label, .desc=T), y = n, label = label) +
geom_bar(stat = "identity", fill = "#A11D21", width = 0.7) +
geom_text(
position = position_dodge(width = .9),
vjust = -0.5, #hjust = .5,
size = 3
) +
labs(x = "País", y = "Frequência") +
theme_estat()
dados_mulheres_medalha5<-head(dados_mulheres_medalha$label,5)
dados_mulheres_medalha5<-head(dados_mulheres_medalha,5)
View(dados_mulheres_medalha5)
dados_mulheres_medalha5<-arrange(dados_mulheres_medalha,n)
View(dados_mulheres_medalha5)
dados_mulheres_medalha5<-tail(dados_mulheres_medalha5,5)
View(dados_mulheres_medalha5)
ggplot(dados_mulheres_medalha) +
aes(x = fct_reorder(Team, label, .desc=T), y = n, label = label) +
geom_bar(stat = "identity", fill = "#A11D21", width = 0.7) +
geom_text(
position = position_dodge(width = .9),
vjust = -0.5, #hjust = .5,
size = 3
) +
labs(x = "País", y = "Frequência") +
theme_estat()
ggplot(dados_mulheres_medalha5) +
aes(x = fct_reorder(Team, label, .desc=T), y = n, label = label) +
geom_bar(stat = "identity", fill = "#A11D21", width = 0.7) +
geom_text(
position = position_dodge(width = .9),
vjust = -0.5, #hjust = .5,
size = 3
) +
labs(x = "País", y = "Frequência") +
theme_estat()
ggplot(dados_mulheres_medalha5) +
aes(x = fct_reorder(Team, label, .desc=T), y = label, label = label) +
geom_bar(stat = "identity", fill = "#A11D21", width = 0.7) +
geom_text(
position = position_dodge(width = .9),
vjust = -0.5, #hjust = .5,
size = 3
) +
labs(x = "País", y = "Frequência") +
theme_estat()
ggplot(dados_mulheres_medalha5) +
aes(x = fct_reorder(Team, n, .desc=T), y = n, label = label) +
geom_bar(stat = "identity", fill = "#A11D21", width = 0.7) +
geom_text(
position = position_dodge(width = .9),
vjust = -0.5, #hjust = .5,
size = 3
) +
labs(x = "País", y = "Frequência") +
theme_estat()
dados_mulheres_medalha
dados_mulheres_medalha5
dados_mulheres_medalha5[.-c(1,3)]
dados_mulheres_medalha5[,-c(1,3)]
dados_mulheres_medalha5[,c(1,4)]
dados_mulheres_medalha5[,c(1,5)]
reorder(dados_mulheres_medalha5[,c(1,5)],label)
reorder(dados_mulheres_medalha5[,c(1,5)],dados_mulheres_medalha5$label)
dados_mulheres_medalha5<-(dados_mulheres_medalha5[,c(1,5)]
dados_mulheres_medalha5<-(dados_mulheres_medalha5[,c(1,5)]
dados_mulheres_medalha5<-(dados_mulheres_medalha5[,c(1,5)]
dados_mulheres_medalha5<-dados_mulheres_medalha5[,c(1,5)]
dados_mulheres_medalha5<-dados_mulheres_medalha5[,c(1,5)]
View(dados_mulheres_medalha5)
arrenge(dados_mulheres_medalha5,label)
arrange(dados_mulheres_medalha5,label)
dados_mulheres_medalha5<-arange(dados_mulheres_medalha5,label)
dados_mulheres_medalha5<-arrange(dados_mulheres_medalha5,label)
dados_mulheres_medalha5<-arrange(dados_mulheres_medalha5,dados_mulheres_medalha5$label)
dados_mulheres_medalha5<-arrange(dados_mulheres_medalha,n)
View(dados_mulheres_medalha5)
dados_mulheres_medalha5<-arrange(dados_mulheres_medalha,n)
library(ggplot2)
library(readxl)
library(latexpdf)
library(tidyverse)
library(dplyr)
dados_mulheres_medalha5<-arrange(dados_mulheres_medalha5,dados_mulheres_medalha5$label)
View(dados_mulheres_medalha5)
dados_mulheres_medalha5<-arrange(dados_mulheres_medalha,n)
dados_mulheres_medalha5<-tail(dados_mulheres_medalha5,5)
dados_mulheres_medalha5<-arrange(dados_mulheres_medalha5,desc(n))
dados_mulheres_medalha5<-dados_mulheres_medalha5[,c(1,5)]
View(dados_mulheres_medalha5)
dados_mulheres_medalha5
#| fig-align: center
dados_mulheres_medalha5
dados_mulheres_medalha5<-arrange(dados_mulheres_medalha,n)
dados_mulheres_medalha5<-tail(dados_mulheres_medalha5,5)
dados_mulheres_medalha5tabela<-arrange(dados_mulheres_medalha5,desc(n))
dados_mulheres_medalha5<-dados_mulheres_medalha5[,c(1,5)]
View(dados_mulheres_medalha5)
View(dados_mulheres_medalha5tabela)
#| fig-align: center
dados_mulheres_medalha5
dados_mulheres_medalha5<-arrange(dados_mulheres_medalha,n)
dados_mulheres_medalha5<-tail(dados_mulheres_medalha5,5)
dados_mulheres_medalha5tabela<-arrange(dados_mulheres_medalha5,desc(n))
dados_mulheres_medalha5tabela<-dados_mulheres_medalha5tabela[,c(1,5)]
#| fig-align: center
dados_mulheres_medalha5
#| fig-align: center
dados_mulheres_medalha5tabela
\textbf{ }
| United States | 146(16,3%) |
\begin{table}[]
\begin{table}[]
\begin{table}[]
library(tinytex)
\begin{table}[]
\begin{table}[]
#| label: tbl-eddiefy
#| label: tbl-eddiefy
\begin{table}[]
| \begin{table}[]                             |                                                      |                |   |   |
ggsave("colunas-uni-freq.pdf", width = 158, height = 93, units = "mm"
)
ggsave("colunas-uni-freq.pdf", width = 158, height = 93, units = "mm"
)
contagem <- dados_mulheres_medalha5 %>%
group_by(Team) %>%
summarise(Freq = n()) %>%
mutate(Prop = round(100*(Freq/sum(Freq)), 1)) %>%
arrange(desc(drv)) %>%
mutate(posicao = cumsum(Prop) - 0.5*Prop)
contagem <- dados_mulheres_medalha5 %>%
group_by(Team) %>%
summarise(Freq = n()) %>%
mutate(Prop = round(100*(Freq/sum(Freq)), 1)) %>%
arrange(desc(Team)) %>%
mutate(posicao = cumsum(Prop) - 0.5*Prop)
ggplot(contagem) +
aes(x = factor(""), y = Prop , fill = factor(Team)) +
geom_bar(width = 1, stat = "identity") +
coord_polar(theta = "y") +
geom_text(
aes(x = 1.8, y = posicao, label = paste0(Prop, "%")),
color = "black"
) +
theme_void() +
theme(legend.position = "top") +
scale_fill_manual(values = estat_colors, name = 'DRV')
ggsave("setor.pdf", width = 158, height = 93, units = "mm")
