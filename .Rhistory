library(latexpdf)
library(tidyverse)
library(dplyr)
library(tinytex)
ggplot(mulheres5) +
aes(x = fct_reorder(Team, n, .desc=T), y = n, label = label) +
geom_bar(stat = "identity", fill = "#A11D21", width = 0.7) +
geom_text(
position = position_dodge(width = .9),
vjust = -0.5, #hjust = .5,
size = 3
) +
labs(x = "País", y = "Frequência") +
theme_estat()
library(readxl)
library(ggplot2)
library(dplyr)
library(tidyverse)
library(latexpdf)
estat_colors <- c(
"#A11D21", "#003366", "#CC9900",
"#663333", "#FF6600", "#CC9966",
"#999966", "#006606", "#008091",
"#041835", "#666666" )
theme_estat <- function(...) {
theme <- ggplot2::theme_bw() +
ggplot2::theme(
axis.title.y = ggplot2::element_text(colour = "black", size = 12),
axis.title.x = ggplot2::element_text(colour = "black", size = 12),
axis.text = ggplot2::element_text(colour = "black", size = 9.5)
,
panel.border = ggplot2::element_blank(),
axis.line = ggplot2::element_line(colour = "black"),
legend.position = "top",
...
)
return(
list(
theme,
scale_fill_manual(values = estat_colors),
scale_colour_manual(values = estat_colors)
)
)
}
library(readxl)
library(ggplot2)
library(dplyr)
library(tidyverse)
library(latexpdf)
estat_colors <- c(
"#A11D21", "#003366", "#CC9900",
"#663333", "#FF6600", "#CC9966",
"#999966", "#006606", "#008091",
"#041835", "#666666" )
theme_estat <- function(...) {
theme <- ggplot2::theme_bw() +
ggplot2::theme(
axis.title.y = ggplot2::element_text(colour = "black", size = 12),
axis.title.x = ggplot2::element_text(colour = "black", size = 12),
axis.text = ggplot2::element_text(colour = "black", size = 9.5)
,
panel.border = ggplot2::element_blank(),
axis.line = ggplot2::element_line(colour = "black"),
legend.position = "top",
...
)
return(
list(
theme,
scale_fill_manual(values = estat_colors),
scale_colour_manual(values = estat_colors)
)
)
}
library(readxl)
library(ggplot2)
library(dplyr)
library(tidyverse)
library(latexpdf)
estat_colors <- c(
"#A11D21", "#003366", "#CC9900",
"#663333", "#FF6600", "#CC9966",
"#999966", "#006606", "#008091",
"#041835", "#666666" )
theme_estat <- function(...) {
theme <- ggplot2::theme_bw() +
ggplot2::theme(
axis.title.y = ggplot2::element_text(colour = "black", size = 12),
axis.title.x = ggplot2::element_text(colour = "black", size = 12),
axis.text = ggplot2::element_text(colour = "black", size = 9.5)
,
panel.border = ggplot2::element_blank(),
axis.line = ggplot2::element_line(colour = "black"),
legend.position = "top",
...
)
return(
list(
theme,
scale_fill_manual(values = estat_colors),
scale_colour_manual(values = estat_colors)
)
)
}
library(ggplot2)
library(readxl)
library(latexpdf)
library(tidyverse)
library(dplyr)
library(tinytex)
dados<-read_excel("E:/arquivos R/Olimpiadas 2000 - 2016.xlsx")
Olimpiadas_ATHENAS <- read_excel("E:/arquivos R/Olimpiadas 2000 - 2016.xlsx",
sheet = "Athina")
Olimpiadas_BEIJING <- read_excel("E:/arquivos R/Olimpiadas 2000 - 2016.xlsx",
sheet = "Beijing")
Olimpiadas_LONDRES <- read_excel("E:/arquivos R/Olimpiadas 2000 - 2016.xlsx",
sheet = "London")
Olimpiadas_RIO <- read_excel("E:/arquivos R/Olimpiadas 2000 - 2016.xlsx",
sheet = "Rio de Janeiro")
Olimpiadas_SIDNEY <- read_excel("E:/arquivos R/Olimpiadas 2000 - 2016.xlsx",
sheet = "Sydney")
colnames(Olimpiadas_ATHENAS)<-c("Names","Gender","Age","Height (cm)","Weight (lbs)","Team","Sport","Event","Medal")
colnames(Olimpiadas_BEIJING)<-c("Names","Gender","Age","Height (cm)","Weight (lbs)","Team","Sport","Event","Medal")
colnames(Olimpiadas_LONDRES)<-c("Names","Gender","Age","Height (cm)","Weight (lbs)","Team","Sport","Event","Medal")
colnames(Olimpiadas_RIO)<-c("Names","Gender","Age","Height (cm)","Weight (lbs)","Team","Sport","Event","Medal")
colnames(Olimpiadas_SIDNEY)<-c("Names","Gender","Age","Height (cm)","Weight (lbs)","Team","Sport","Event","Medal")
dados<-rbind(Olimpiadas_ATHENAS,Olimpiadas_BEIJING,Olimpiadas_LONDRES,Olimpiadas_RIO,Olimpiadas_SIDNEY)
dados<-dados %>% filter(!is.na(dados$Medal))
dados$`Weight (lbs)`<-dados$`Weight (lbs)`*0.45359237
dados$`Height (cm)`<-dados$`Height (cm)`/100
dados<-mutate(dados, IMC=dados$`Weight (lbs)`/(dados$`Height (cm)`**2))
dados_mulheres<-filter(dados,Gender=="F")
frequencia_mulheres <- dados_mulheres %>%
filter(!is.na(Team)) %>%
count(Team) %>%
mutate(
freq = n,
relative_freq = round((freq / sum(freq)) * 100, 1),
freq = gsub("\\.", ",", relative_freq) %>% paste("%", sep = ""),
label = str_c(n, " (", freq, ")") %>% str_squish()
)
mulheres5<-arrange(frequencia_mulheres,n)
mulheres5<-tail(mulheres5,5)
mulheres5<-arrange(mulheres5,desc(n))
mulheres5$Team<-c("Estados Unidos","Rússia","China","Austrália","Alemanha")
library(ggplot2)
library(readxl)
library(latexpdf)
library(tidyverse)
library(dplyr)
library(tinytex)
dados<-read_excel("E:/arquivos R/Olimpiadas 2000 - 2016.xlsx")
Olimpiadas_ATHENAS <- read_excel("E:/arquivos R/Olimpiadas 2000 - 2016.xlsx",
sheet = "Athina")
Olimpiadas_BEIJING <- read_excel("E:/arquivos R/Olimpiadas 2000 - 2016.xlsx",
sheet = "Beijing")
Olimpiadas_LONDRES <- read_excel("E:/arquivos R/Olimpiadas 2000 - 2016.xlsx",
sheet = "London")
Olimpiadas_RIO <- read_excel("E:/arquivos R/Olimpiadas 2000 - 2016.xlsx",
sheet = "Rio de Janeiro")
Olimpiadas_SIDNEY <- read_excel("E:/arquivos R/Olimpiadas 2000 - 2016.xlsx",
sheet = "Sydney")
colnames(Olimpiadas_ATHENAS)<-c("Names","Gender","Age","Height (cm)","Weight (lbs)","Team","Sport","Event","Medal")
colnames(Olimpiadas_BEIJING)<-c("Names","Gender","Age","Height (cm)","Weight (lbs)","Team","Sport","Event","Medal")
colnames(Olimpiadas_LONDRES)<-c("Names","Gender","Age","Height (cm)","Weight (lbs)","Team","Sport","Event","Medal")
colnames(Olimpiadas_RIO)<-c("Names","Gender","Age","Height (cm)","Weight (lbs)","Team","Sport","Event","Medal")
colnames(Olimpiadas_SIDNEY)<-c("Names","Gender","Age","Height (cm)","Weight (lbs)","Team","Sport","Event","Medal")
dados<-rbind(Olimpiadas_ATHENAS,Olimpiadas_BEIJING,Olimpiadas_LONDRES,Olimpiadas_RIO,Olimpiadas_SIDNEY)
dados<-dados %>% filter(!is.na(dados$Medal))
dados$`Weight (lbs)`<-dados$`Weight (lbs)`*0.45359237
dados$`Height (cm)`<-dados$`Height (cm)`/100
dados<-mutate(dados, IMC=dados$`Weight (lbs)`/(dados$`Height (cm)`**2))
dados_mulheres<-filter(dados,Gender=="F")
frequencia_mulheres <- dados_mulheres %>%
filter(!is.na(Team)) %>%
count(Team) %>%
mutate(
freq = n,
relative_freq = round((freq / sum(freq)) * 100, 1),
freq = gsub("\\.", ",", relative_freq) %>% paste("%", sep = ""),
label = str_c(n, " (", freq, ")") %>% str_squish()
)
mulheres5<-arrange(frequencia_mulheres,n)
mulheres5<-tail(mulheres5,5)
mulheres5<-arrange(mulheres5,desc(n))
mulheres5$Team<-c("Estados Unidos","Rússia","China","Austrália","Alemanha")
ggplot(mulheres5) +
aes(x = fct_reorder(Team, n, .desc=T), y = n, label = label) +
geom_bar(stat = "identity", fill = "#A11D21", width = 0.7) +
geom_text(
position = position_dodge(width = .9),
vjust = -0.5, #hjust = .5,
size = 3
) +
labs(x = "País", y = "Frequência") +
theme_estat()
ggsave("colunas-uni-freq.pdf", width = 158, height = 93, units = "mm"
)
dados_esporte<-filter(dados, Sport %in% c("Gymnastics","Football","Judo","Athletics","Badminton"))
dados_esporte <- dados_esporte %>%
filter(!is.na(`Height (cm)`))
dados_esporte <- dados_esporte %>%
filter(!is.na(`Weight (lbs)`))
View(dados_esporte)
dados_esporte$Sport<-factor(dados_esporte$Sport)
levels(dados_esporte$Sport)[levels(dados_esporte$Sport) %in% c("Athletics")]<-"Atletismo"
levels(dados_esporte$Sport)[levels(dados_esporte$Sport) %in% c("Gymnastics")]<-"Ginástica"
levels(dados_esporte$Sport)[levels(dados_esporte$Sport) %in% c("Football")]<-"Futebol"
levels(dados_esporte$Sport)[levels(dados_esporte$Sport) %in% c("Judo")]<-"Judô"
ggplot(dados_esporte) +
aes(x = reorder(Sport, IMC, FUN= median), y = IMC) +
geom_boxplot(fill = c("#A11D21"), width = 0.5) +
stat_summary(
fun = "mean", geom = "point", shape = 23, size = 3, fill = "white"
) +
labs(x = "Esporte", y = "IMC") +
theme_estat()
ggsave("box_bi4.pdf", width = 158, height = 93, units = "mm")
dados_individual <- dados%>%
count(Names) %>%
mutate(
freq = n,
label = str_c(n) %>% str_squish()
)
View(dados_individual)
dados_individual <- dados%>%
count(Names,Medal) %>%
mutate(
freq = n,
label = str_c(n) %>% str_squish()
)
View(dados_individual)
dados_individual <- dados%>%
count(Names) %>%
mutate(
freq = n,
label = str_c(n) %>% str_squish()
)
dados_individual <- dados%>%
count(Names,Medal) %>%
mutate(
freq = n,
label = str_c(n) %>% str_squish()
)
dados_individual2 <- dados%>%
count(Names) %>%
mutate(
freq = n)
dados_individual <- dados%>%
count(Names,Medal) %>%
mutate(
freq = n,
label = str_c(n) %>% str_squish()
)
View(dados_individual2)
dados_individual<-left_join(dados_individual,dados_individual2,by="Names")
View(dados_individual)
na.rm(dados_individual2)
rm(dados_individual2)
View(dados_individual)
top3<-arrange(top3,desc(n.y))
dados_individual<-top3
dados_individual<-top3
top3<-dados_individual
top3<-arrange(top3,desc(n.y))
View(top3)
top3<-head(top3,9)
dados_individual <- dados_individual %>%
count(Names,Medal) %>%
mutate(
freq = n,
relative_freq = round((freq / sum(freq)) * 100, 1),
freq = gsub("\\.", ",", relative_freq) %>% paste("%", sep = ""),
label = str_c(n, " (", freq, ")") %>% str_squish()
)
View(dados_individual)
dados_individual <- dados%>%
count(Names,Medal) %>%
mutate(
freq = n,
label = str_c(n) %>% str_squish()
)
dados_individual2 <- dados%>%
count(Names) %>%
mutate(
freq = n)
dados_individual<-left_join(dados_individual,dados_individual2,by="Names")
rm(dados_individual2)
top3<-dados_individual
top3<-arrange(top3,desc(n.y))
top3<-head(top3,9)
View(dados_individual)
top3<-top3 %>%
mutate(
freq = n,
relative_freq = round((freq / sum(freq)) * 100, 1),
freq = gsub("\\.", ",", relative_freq) %>% paste("%", sep = ""),
label = str_c(n, " (", freq, ")") %>% str_squish()
)
top3<-top3 %>%
mutate(
relative_freq = round((freq.x / sum(freq.x)) * 100, 1),
freq = gsub("\\.", ",", relative_freq) %>% paste("%", sep = ""),
label = str_c(n, " (", freq, ")") %>% str_squish()
)
View(top3)
top3[4]<-c("7,1%","82,1%","10,8%","41,7%","25%","33,3%","25%","50%","25%")
porcentagens <- str_c(top3$freq_relativa, "%") %>% str_replace("\\.", ",")
legendas <- str_squish(str_c(top3$freq, " (", porcentagens, ")"))
ggplot(top3) +
aes(
x = fct_reorder(Names, freq, .desc = T), y = freq,
fill = Medalha, label = legendas
) +
geom_col(position = position_dodge2(preserve = "single", padding =0)) +
geom_text(
position = position_dodge(width = .9),
vjust = -0.5, hjust = 0.5,
size = 2.9
) +
labs(x = "Atleta", y = "Frequência") +
ylim(0,6)+
theme_estat()
porcentagens <- str_c(top3$freq.x, "%") %>% str_replace("\\.", ",")
legendas <- str_squish(str_c(top3$n.y, " (", porcentagens, ")"))
ggplot(top3) +
aes(
x = fct_reorder(Names, n.y, .desc = T), y = n.y,
fill = Medal, label = legendas
) +
geom_col(position = position_dodge2(preserve = "single", padding =0)) +
geom_text(
position = position_dodge(width = .9),
vjust = -0.5, hjust = 0.5,
size = 2.9
) +
labs(x = "Atleta", y = "Frequência") +
ylim(0,6)+
theme_estat()
ggsave("colunas-bi-freq3.pdf", width = 158, height = 93, units = "mm")
porcentagens <- str_c(top3$freq.x) %>% str_replace("\\.", ",")
legendas <- str_squish(str_c(top3$n.y, " (", porcentagens, ")"))
porcentagens <- str_c(top3$freq.x) %>% str_replace("\\.", ",")
legendas <- str_squish(str_c(top3$n.y, " (", porcentagens, ")"))
ggplot(top3) +
aes(
x = fct_reorder(Names, n.y, .desc = T), y = n.y,
fill = Medal, label = legendas
) +
geom_col(position = position_dodge2(preserve = "single", padding =0)) +
geom_text(
position = position_dodge(width = .9),
vjust = -0.5, hjust = 0.5,
size = 2.9
) +
labs(x = "Atleta", y = "Frequência") +
ylim(0,6)+
theme_estat()
ggsave("colunas-bi-freq3.pdf", width = 158, height = 93, units = "mm")
porcentagens <- str_c(top3$freq.x) %>% str_replace("\\.", ",")
legendas <- str_squish(str_c(top3$n.y, " (", porcentagens, ")"))
ggplot(top3) +
aes(
x = fct_reorder(Names, n.y, .desc = T), y = n.y,
fill = Medal, label = legendas
) +
geom_col(position = position_dodge2(preserve = "single", padding =0)) +
geom_text(
position = position_dodge(width = .9),
vjust = -0.5, hjust = 0.5,
size = 2.9
) +
labs(x = "Atleta", y = "Frequência") +
theme_estat()
ggsave("colunas-bi-freq3.pdf", width = 158, height = 93, units = "mm")
porcentagens <- str_c(top3$freq.x) %>% str_replace("\\.", ",")
legendas <- str_squish(str_c(top3$n.y, " (", porcentagens, ")"))
ggplot(top3) +
aes(
x = fct_reorder(Names, n.x, .desc = T), y = n.x,
fill = Medal, label = legendas
) +
geom_col(position = position_dodge2(preserve = "single", padding =0)) +
geom_text(
position = position_dodge(width = .9),
vjust = -0.5, hjust = 0.5,
size = 2.9
) +
labs(x = "Atleta", y = "Frequência") +
theme_estat()
ggsave("colunas-bi-freq3.pdf", width = 158, height = 93, units = "mm")
porcentagens <- str_c(top3$freq.x) %>% str_replace("\\.", ",")
legendas <- str_squish(str_c(top3$n.x, " (", porcentagens, ")"))
ggplot(top3) +
aes(
x = fct_reorder(Names, n.x, .desc = T), y = n.x,
fill = Medal, label = legendas
) +
geom_col(position = position_dodge2(preserve = "single", padding =0)) +
geom_text(
position = position_dodge(width = .9),
vjust = -0.5, hjust = 0.5,
size = 2.9
) +
labs(x = "Atleta", y = "Frequência") +
theme_estat()
ggsave("colunas-bi-freq3.pdf", width = 158, height = 93, units = "mm")
porcentagens <- str_c(top3$freq.x) %>% str_replace("\\.", ",")
legendas <- str_squish(str_c(top3$n.x, " (", porcentagens, ")"))
ggplot(top3) +
aes(
x = Names, y = n.x,
fill = Medal, label = legendas
) +
geom_col(position = position_dodge2(preserve = "single", padding =0)) +
geom_text(
position = position_dodge(width = .9),
vjust = -0.5, hjust = 0.5,
size = 2.9
) +
labs(x = "Atleta", y = "Frequência") +
theme_estat()
ggsave("colunas-bi-freq3.pdf", width = 158, height = 93, units = "mm")
ggplot(dados) +
aes(x = dados$`Height (cm)`, y = dados$`Weight (lbs)`) +
geom_point(colour = "#A11D21", size = 2) +
labs(
x = "Altura",
y = "Peso"
) +
geom_smooth(se=F,color="black")+
theme_estat()
ggsave("disp_uni2.pdf", width = 158, height = 93, units = "mm")
top3<-arrange(top3, Medal, by=("Gold","Silver","Bronze")
top3<-arrange(top3, Medal, by=("Gold","Silver","Bronze"))
top3<-arrange(top3, Medal, by=c("Gold","Silver","Bronze"))
top3<-arrange(top3, Medal, by=c("Gold","Silver","Bronze"))
top3<-top3 %>% mutate(c(3,1,2,6,4,5,9,7,8))
top3<-arrange(top3,top3$`c(3, 1, 2, 6, 4, 5, 9, 7, 8)`)
porcentagens <- str_c(top3$freq.x) %>% str_replace("\\.", ",")
legendas <- str_squish(str_c(top3$n.x, " (", porcentagens, ")"))
ggplot(top3) +
aes(
x = Names, y = n.x,
fill = Medal, label = legendas
) +
geom_col(position = position_dodge2(preserve = "single", padding =0)) +
geom_text(
position = position_dodge(width = .9),
vjust = -0.5, hjust = 0.5,
size = 2.9
) +
labs(x = "Atleta", y = "Frequência") +
theme_estat()
ggsave("colunas-bi-freq3.pdf", width = 158, height = 93, units = "mm")
spearman<-cor(dados$`Height (cm)`,dados$`Weight (lbs)`, method = "spearman")
spearman<-cor(dados$`Height (cm)`,dados$`Weight (lbs)`, method = "spearman")
dados2<-dados
dados2<-dados2 %>% filter(!na.rm(dados2$`Height (cm)`))
dados2<-dados2 %>% filter(!na.rm(dados2$`Height (cm)`))
dados2<-dados2 %>% filter(!is.na(dados2$`Height (cm)`))
dados2<-dados2 %>% filter(!is.na(dados2$`Weight (lbs)`))
spearman<-cor(dados$`Height (cm)`,dados$`Weight (lbs)`, method = "spearman",)
spearman
View(dados2)
spearman<-cor(dados2$`Height (cm)`,dados2$`Weight (lbs)`, method = "spearman",)
ggplot(dados2) +
aes(x = dados2$`Height (cm)`, y = dados$`Weight (lbs)`) +
geom_point(colour = "#A11D21", size = 2) +
labs(
x = "Altura",
y = "Peso"
) +
geom_smooth(se=F,color="black")+
theme_estat()
ggplot(dados2) +
aes(x = dados2$`Height (cm)`, y = dados2$`Weight (lbs)`) +
geom_point(colour = "#A11D21", size = 2) +
labs(
x = "Altura",
y = "Peso"
) +
geom_smooth(se=F,color="black")+
theme_estat()
ggsave("disp_uni2.pdf", width = 158, height = 93, units = "mm")
porcentagens <- str_c(top3$freq.x) %>% str_replace("\\.", ",")
legendas <- str_squish(str_c(top3$n.x, " (", porcentagens, ")"))
ggplot(top3) +
aes(
x = Names, y = n.x,
fill = Medal, label = legendas
) +
geom_col(position = position_dodge2(preserve = "single", padding =0)) +
geom_text(
position = position_dodge(width = .9),
vjust = -0.5, hjust = 0.5,
size = 3
) +
labs(x = "Atleta", y = "Frequência") +
theme_estat()
ggsave("colunas-bi-freq3.pdf", width = 158, height = 93, units = "mm")
ggplot(dados2) +
aes(x = dados2$`Height (cm)`, y = dados2$`Weight (lbs)`) +
geom_point(colour = "#A11D21", size = 3) +
labs(
x = "Altura",
y = "Peso"
) +
geom_smooth(se=F,color="black")+
theme_estat()
ggsave("disp_uni2.pdf", width = 158, height = 93, units = "mm")
View(frequencia_mulheres)
